<%-- 
    Document   : newjsp
    Created on : 11/02/2010, 04:41:24 PM
    Author     : ronald
--%>

<%@page contentType="text/html" pageEncoding="UTF-8" session="true"%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" href="./images/favicon.ico" />
        <title>FinanceBank</title>
        <meta name="keywords" content="FinanceBank" />
        <meta name="description" content="Sistema financiero" />
        <link href="default.css" rel="stylesheet" type="text/css" />
        <link href='css/tabla.css' rel='stylesheet' type='text/css' />
        <script type="text/javascript" src="js/prototype.js"> </script>
        <script type="text/javascript" src="js/effects.js"> </script>
        <script type="text/javascript" src="js/window.js"> </script>
        <script type="text/javascript" src="js/debug.js"> </script>
        <link href="css/themes/default.css" rel="stylesheet" type="text/css"/>
        <link href="css/themes/alert.css" rel="stylesheet" type="text/css"/>
        <link href="css/themes/alphacube.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="js/validacion.js"></script>
        <script language="javascript" type="text/javascript">
            var eeisus=0;
            var eetrue="VERDADERO";
            var eefalse="FALSO";
            var eedec=".";
            var eeth=",";
            var eedecreg=new RegExp("\\.","g");
            var eethreg=new RegExp(",","g");
            var eecurrencyreg=new RegExp("€","g");
            var eepercentreg=new RegExp("%","g");
            var fmtdaynamesshort=new Array("dom","lun","mar","mié","jue","vie","sáb");
            var fmtdaynameslong=new Array("domingo","lunes","martes","miércoles","jueves","viernes","sábado");
            var fmtmonthnamesshort=new Array("ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic");
            var fmtmonthnameslong=new Array("enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre");
            var fmtstrings=new Array(","," ","S/.","pta","€","/","$");
            var fmtdate6=new Array(34,33,25,2);
            var fmtdate7=new Array(25,2,33,35);
            var fmtdate8=new Array(25,2,33,36);
            var fmtdate9=new Array(7,37,3,37,11);
            var fmtdate10=new Array(38,25,2);

            function myIsNaN(x){
                return(isNaN(x)||(typeof x=='number'&&!isFinite(x)));
            }

            function round(n,nd){
                if(isFinite(n)&&isFinite(nd)){
                    var sign_n=(n<0)?-1:1;
                    var abs_n=Math.abs(n);
                    var factor=Math.pow(10,nd);
                    return sign_n*Math.round(abs_n*factor)/factor;
                }else{
                    return NaN;
                }
            }

            function b2s(b){
                return b?eetrue:eefalse;
            }

            function eeparseFloat(str){
                str=String(str).replace(eedecreg,".");
                var res=parseFloat(str);
                if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            function eeparsePercent(str){
                var parts=String(str).split('%');
                var tmp=String(parts[0]).replace(eedecreg,".");
                var res=parseFloat(tmp)/100;if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            var near0RegExp=new RegExp("[.](.*0000000|.*9999999)");

            function eedisplayFloat(x){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var str=String(x);
                    if(near0RegExp.test(str)){
                        x=round(x,8);
                        str=String(x);
                    }
                    return str.replace(/\./g,eedec);
                }
            }

            function eedisplayFloatV(x){
                if(x=="")return x;
                if(isFinite(x)){
                    return eedisplayFloat(x);
                }else{
                    return x;
                }
            }

            function eedisplayFloatND(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var res=round(x,nd);
                    if(nd>0){
                        var str=String(res);
                        if(str.indexOf('e')!=-1)
                            return str;
                        if(str.indexOf('E')!=-1)
                            return str;
                        var parts=str.split('.');
                        if(parts.length<2){
                            var decimals=('00000000000000').substring(0,nd);
                            return(parts[0]).toString()+eedec+decimals;
                        }else{
                            var decimals=((parts[1]).toString()+'00000000000000').substring(0,nd);
                            return(parts[0]).toString()+eedec+decimals;
                        }
                    }else{
                        return res;
                    }
                }
            }

            function eedisplayPercentND(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    return eedisplayFloatND(x*100,nd)+'%';
                }
            }

            function eeparseFloatTh(str){
                str=String(str).replace(eethreg,"");
                str=String(str).replace(eedecreg,".");
                var res=parseFloat(str);
                if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            function eedisplayFloatNDTh(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var res=round(x,nd);
                    if(nd>0){
                        var str=String(res);
                        if(str.indexOf('e')!=-1)
                            return str;
                        if(str.indexOf('E')!=-1)
                            return str;
                        var parts=str.split('.');
                        var res2=eeinsertThousand(parts[0].toString());
                        if(parts.length<2){
                            var decimals=('00000000000000').substring(0,nd);
                            return(res2+eedec+decimals);
                        }else{
                            var decimals=((parts[1]).toString()+'00000000000000').substring(0,nd);
                            return(res2+eedec+decimals);
                        }
                    }else{
                        return(eeinsertThousand(res.toString()));
                    }
                }
            }

            var eeparseFloatVreg=new RegExp("^ *-?[0-9.]+ *$");

            function eeparseFloatV(str){
                if(str=="")
                    return str;str=String(str).replace(eedecreg,".");
                if(!eeparseFloatVreg.test(str)){
                    return str;
                }
                var res=parseFloat(str);
                if(isNaN(res)){
                    return str;
                }else{
                    return res;
                }
            }

            function eeinsertThousand(whole){
                if(whole==""||whole.indexOf("e")>=0){
                    return whole;
                }else{
                    var minus_sign="";
                    if(whole.charAt(0)=="-"){
                        minus_sign="-";
                        whole=whole.substring(1);
                    }
                    var res="";
                    var str_length=whole.length-1;
                    for(var ii=0;ii<=str_length;ii++){
                        if(ii>0&&ii%3==0){
                            res=eeth+res;
                        }
                        res=whole.charAt(str_length-ii)+res;
                    }
                    return minus_sign+res;
                }
            }

            function validar(e){
                obj=e.srcElement || e.target;
                tecla_codigo = (document.all) ? e.keyCode : e.which;
                if(tecla_codigo<14)return true;
                patron =/[\d.]/;
                tecla_valor = String.fromCharCode(tecla_codigo);
                control=(tecla_codigo==46 && (/[.]/).test(obj.value))?false:true
                return patron.test(tecla_valor) &&  control;
            }
        </script>
        <script>
            function clean(er){
                this.document.getElementById(er+'idpersona').value="";
                this.document.getElementById(er+'ruc').value="";
                this.document.getElementById(er+'dni').value="";
                this.document.getElementById(er+'nombres').value="";
                this.document.getElementById(er+'apellidos').value="";
                this.document.getElementById(er+'email').value="";
                this.document.getElementById(er+'ubigeo').value="";
                this.document.getElementById(er+'telefono').value="";
                this.document.getElementById(er+'celular').value="";
                this.document.getElementById(er+'direccion').value="";
            }
                            
            function natural(er){
                clean(er);
                this.document.getElementById(er+'ruc').disabled=true;
                this.document.getElementById(er+'tr_dni').style.visibility='';
                this.document.getElementById(er+'td_nombres').style.display='';
                this.document.getElementById(er+'td_razonsocial').style.display='none';
                this.document.getElementById(er+'tr_apellidos').style.visibility='';
                this.document.getElementById(er+'tr_ubigeo').style.visibility='';
                this.document.getElementById(er+'tr_dni').style.visibility='';
                this.document.getElementById(er+'tr_dni').style.visibility='';
            }

            function juridica(er){
                this.document.getElementById(er+'ruc').disabled='';
                clean(er);
                this.document.getElementById(er+'tr_dni').style.visibility='hidden';
                this.document.getElementById(er+'td_nombres').style.display='none';
                this.document.getElementById(er+'td_razonsocial').style.display='';
                this.document.getElementById(er+'tr_apellidos').style.visibility='hidden';
                this.document.getElementById(er+'tr_ubigeo').style.visibility='hidden';
                this.document.getElementById(er+'tr_dni').style.visibility='hidden';
                this.document.getElementById(er+'tr_dni').style.visibility='hidden';
            }

            var bure;
            function buscarpersona(er){
                var dni = '';
                var ruc = '';
                var categoria='';
                var nombres='';
                var apellidos='';
                var idp='';
                if(er=='RF' || er=='RH'){
                    dni = document.getElementById("Rdni").value;
                    ruc = document.getElementById("Rruc").value;
                    nombres=document.getElementById("Rnombres").value;
                    apellidos=document.getElementById("Rapellidos").value;
                    idp=document.getElementById("Ridpersona").value;
                    var j;
                    for (j=0;j<document.f1.Rcategoria.length;j++){
                        if (document.f1.Rcategoria[j].checked)
                            break;
                    }
                    categoria = document.f1.Rcategoria[j].value;
                    if(er=='RH'){
                        if(idp.length>5){
                            return;
                        }
                        if(nombres.length<2){
                            return;
                        }
                    }else{
                        if(dni.length<7){
                            return;
                        }
                    }
                }else if(er=='EF'){
                    dni = document.getElementById("Edni").value;
                    ruc = document.getElementById("Eruc").value;
                    if(dni.length<7){
                        return;
                    }
                    this.document.getElementById('forpago2').disabled=true;
                    this.document.getElementById('forpago1').selected=true;
                    this.document.getElementById('detalle_cuenta').innerHTML="";
                    this.document.getElementById('grupo').value="";
                    var j;
                    for (j=0;j<document.f1.Ecategoria.length;j++){
                        if (document.f1.Ecategoria[j].checked)
                            break;
                    }
                    categoria = document.f1.Ecategoria[j].value;
                }else{
                    nombres=document.getElementById("Enombres").value;
                    apellidos=document.getElementById("Eapellidos").value;
                    idp=document.getElementById("Ridpersona").value;
                    var j;
                    for (j=0;j<document.f1.Ecategoria.length;j++){
                        if (document.f1.Ecategoria[j].checked)
                            break;
                    }
                    categoria = document.f1.Ecategoria[j].value;
                    if(idp.length>5){
                        return;
                    }
                    if(nombres.length<2){
                        return;
                    }
                }
                if (window.XMLHttpRequest) {
                    bure = new XMLHttpRequest();
                } else if (window.ActiveXObject) {
                    bure = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(bure!=null){
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/Sbuscarpersona?dni="+dni+"&categoria="+categoria+"&er="+er+"&ruc="+ruc+"&nom="+nombres+"&ap="+apellidos;
                    bure.open("GET",url,true);
                    bure.onreadystatechange = procesarRespuesta2;
                    bure.send(null);
                }
            }

            var contenido;
            function procesarRespuesta2(){
                contenido = document.getElementById('detalle');
                contenido.innerHTML="Cargando los datos...";
                if (bure.readyState==4 && bure.status==200) {
                    var names;
                    contenido.innerHTML = bure.responseText;
                    if(document.getElementById('detalle').innerHTML=="R0"){
                        document.getElementById("Ridpersona").value="";
                    }else if(document.getElementById('detalle').innerHTML=="E0"){
                        document.getElementById("Eidpersona").value="";
                        this.document.getElementById('forpago2').disabled=true;
                    }else{
                        if(contenido.innerHTML.length<5)
                            return;
                        var params = document.getElementById('detalle').innerHTML.split('-');
                        for(var i=0; i<params.length; i++) {
                            names = params[i].split('=');
                            if(names[0].length<2){
                                continue;
                            }
                            document.getElementById(names[0]).value= names[1];
                            this.document.getElementById('forpago2').disabled=false;
                        }
                    }
                }
            }

            function currencyFormat(fld, milSep, decSep, e) {
                var key = '';
                var i = 0,j = 0;
                var len = 0,len2 = 0;
                var strCheck = '0123456789';
                var aux = '',aux2 = '';
                var whichCode = (window.Event) ? e.which : e.keyCode;
                if (whichCode <= 18) return true;  // Enter,Delete
                key = String.fromCharCode(whichCode);  // Get key value from key code
                if (strCheck.indexOf(key) == -1) return false;  // Not a valid key
                len = fld.value.length;
                for(i = 0; i < len; i++)
                    if ((fld.value.charAt(i) != '0') && (fld.value.charAt(i) != decSep)) break;
                aux = '';
                for(; i < len; i++)
                    if (strCheck.indexOf(fld.value.charAt(i))!=-1) aux += fld.value.charAt(i);
                aux += key;
                len = aux.length;
                if (len == 0) fld.value = '';
                if (len == 1) fld.value = '0'+ decSep + '0' + aux;
                if (len == 2) fld.value = '0'+ decSep + aux;
                if (len > 2) {
                    aux2 = '';
                    for (j = 0, i = len - 3; i >= 0; i--) {
                        if (j == 3) {
                            aux2 += milSep;
                            j = 0;
                        }
                        aux2 += aux.charAt(i);
                        j++;
                    }
                    fld.value = '';
                    len2 = aux2.length;
                    for (i = len2 - 1; i >= 0; i--)
                        fld.value += aux2.charAt(i);
                    fld.value += decSep + aux.substr(len - 2, len);
                }
                return false;
            }

            function currencyFormat2(fld, milSep, decSep) {
                var key = '';
                var i = 0,j = 0;
                var len = 0,len2 = 0;
                var strCheck = '0123456789';
                var aux ='', aux2 = '';
                len = fld.length;
                for(i = 0; i < len; i++)
                    if ((fld.charAt(i) != '0') && (fld.charAt(i) != decSep)) break;
                aux = '';
                for(; i < len; i++)
                    if (strCheck.indexOf(fld.charAt(i))!=-1) aux += fld.charAt(i);
                aux += key;
                len = aux.length;
                if (len == 0) fld = '';
                if (len == 1) fld = '0'+ decSep + '0' + aux;
                if (len == 2) fld = '0'+ decSep + aux;
                if (len > 2) {
                    aux2 = '';
                    for (j = 0, i = len - 3; i >= 0; i--) {
                        if (j == 3) {
                            aux2 += milSep;
                            j = 0;
                        }
                        aux2 += aux.charAt(i);
                        j++;
                    }
                    fld = '';
                    len2 = aux2.length;
                    for (i = len2 - 1; i >= 0; i--)
                        fld += aux2.charAt(i);
                    fld += decSep + aux.substr(len - 2, len);
                }
                return fld;
            }

            function procesar() {
                /********;***DATOS EMISOR ***************/
                var j;
                for (j=0;j<document.f1.Ecategoria.length;j++){
                    if (document.f1.Ecategoria[j].checked)
                        break;
                }
                var categoria_e = document.f1.Ecategoria[j].value;
                var idpersona_e = document.getElementById('Eidpersona').value;
                var dni_e = document.getElementById("Edni").value;
                if(dni_e.length>0){
                    if(dni_e.length!=8){
                        window.alert("El dni del Emisor tiene que ser de ocho digitos");
                        return;
                    }
                }
                var ruc_e = document.getElementById("Eruc").value;
                if(ruc_e.length>0 && idpersona_e==null){
                    if(ruc_e.length!=11){
                        window.alert("El RUC de Emisor tiene que ser de 11 digitos");
                        return;
                    }
                }
                var nombres_e = document.getElementById("Enombres").value;
                if(nombres_e.length<2){
                    window.alert("El emisor debe ser más espicificado en el nombre/RS");
                    return;
                }
                var apellidos_e = document.getElementById("Eapellidos").value;
                var email_e = document.getElementById("Eemail").value;
                var ubigeo_e = document.getElementById("Eubigeo").value;
                var telefono_e = document.getElementById("Etelefono").value;
                var celular_e = document.getElementById("Ecelular").value;
                var direccion_e = document.getElementById("Edireccion").value;
                /***********DATOS RECEPTOR ***************/
                var k;
                for (k=0;k<document.f1.Rcategoria.length;k++){
                    if (document.f1.Rcategoria[k].checked)
                        break;
                }
                var categoria_r = document.f1.Rcategoria[k].value;
                var idpersona_r = document.getElementById('Ridpersona').value;
                var dni_r = document.getElementById("Rdni").value;
                if(dni_r.length>0){
                    if(dni_r.length!=8){
                        window.alert("El DNI del RECEPTOR tiene que ser de 8 digitos");
                        return;
                    }
                }
                var ruc_r = document.getElementById("Rruc").value;
                if(ruc_r.length>0 && idpersona_r==null){
                    if(ruc_r.length!=11){
                        window.alert("El RUC de RECEPTOR tiene que ser de 11 digitos");
                        return;
                    }
                }
                var nombres_r = document.getElementById("Rnombres").value;
                if(nombres_r.length<2){
                    window.alert("El receptor debe ser más espicificado en el nombre/RS");
                    return;
                }
                var apellidos_r = document.getElementById("Rapellidos").value;
                var email_r = document.getElementById("Remail").value;
                var ubigeo_r = document.getElementById("Rubigeo").value;
                var telefono_r = document.getElementById("Rtelefono").value;
                var celular_r = document.getElementById("Rcelular").value;
                var direccion_r = document.getElementById("Rdireccion").value;
                /***************DATOS DEL GIRO**************************/
                var importe =document.getElementById("monto").value;
                if(importe==""){importe="0";}
                else{importe = importe.replace(/,/gi, "");}
                var j0;
                for (j0=0;j0<document.f1.forpago.length;j0++){
                    if (document.f1.forpago[j0].checked)
                        break;
                }
                var fpago_importe = document.f1.forpago[j0].value;
                var j1;
                for (j1=0;j1<document.f1.usuariop.length;j1++){
                    if (document.f1.usuariop[j1].checked)
                        break;
                }
                var pagador_comision = document.f1.usuariop[j1].value;
                var comision = document.getElementById('monto_comision').value;
                if(document.getElementById('Icomision').checked) {
                    if(comision==""){comision=0;}
                    else{comision = comision.replace(/,/gi, "");}
                }else{
                    comision=0;
                }
                var j2;
                for (j2=0;j2<document.f1.formap.length;j2++){
                    if (document.f1.formap[j2].checked)
                        break;
                }
                var fpago_comision = document.f1.formap[j2].value;
                var cod_moneda = document.f1.moneda[document.f1.moneda.selectedIndex].value;
                var cod_filial = document.f1.filial_recepcion[document.f1.filial_recepcion.selectedIndex].value;
                var  idcuentapersona =0;
                if(document.f1.cuenta!=null && fpago_importe =="CUENTA"){
                    var i1 =0;
                    for (i1=0;i1<document.f1.cuenta.length;i1++){
                        if (document.f1.cuenta[i1].checked)
                            break;
                    }
                    if(i1==document.f1.cuenta.length){
                        idcuentapersona=-1;
                    } else{
                        if(document.f1.cuenta.length==null){
                            idcuentapersona= document.f1.cuenta.value;
                        }else{
                            idcuentapersona= document.f1.cuenta[i1].value;
                        }
                    }
                }
                if(importe==0){window.alert("¡¡EL MONTO A GIRAR DEBE SER MAYO A CERO!!"); }else{
                    if(idcuentapersona==-1){window.alert("¡¡DEBE SELECCIONAR UNA CUENTA!!");}else{
                        var Monto = parseFloat(importe) + parseFloat(comision);
                        var d = parseFloat(Saldo) - parseFloat(Monto);
                        if(fpago_importe !="CUENTA"){d=9999;}
                        if(d<0){
                            window.alert("¡¡NO TIENE DINERO SUFICIENTE EN LA CUENTA!!");
                        }else{
                            var answer = window.confirm ("¿ESTA SEGURO REALIZAR EL GIRO?");
                            if (answer) {
                                req2 = null;
                                if (window.XMLHttpRequest) {
                                    req2 = new XMLHttpRequest();
                                } else if (window.ActiveXObject) {
                                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                                }
                                if(req2!=null){
                                    var PATH = "<%= request.getContextPath()%>";
                                    var url = PATH + "/Sprocesar?"+
                                        "categoria_e="+categoria_e+
                                        "&idpersona_e="+idpersona_e+
                                        "&dni_e="+dni_e+
                                        "&ruc_e="+ruc_e+
                                        "&nombres_e="+nombres_e+
                                        "&apellidos_e="+apellidos_e+
                                        "&email_e="+email_e+
                                        "&ubigeo_e="+ubigeo_e+
                                        "&telefono_e="+telefono_e+
                                        "&celular_e="+celular_e+
                                        "&direccion_e="+direccion_e+
                                        "&categoria_r="+categoria_r+
                                        "&idpersona_r="+idpersona_r+
                                        "&dni_r="+dni_r+
                                        "&ruc_r="+ruc_r+
                                        "&nombres_r="+nombres_r+
                                        "&apellidos_r="+apellidos_r+
                                        "&email_r="+email_r+
                                        "&ubigeo_r="+ubigeo_r+
                                        "&telefono_r="+telefono_r+
                                        "&celular_r="+celular_r+
                                        "&direccion_r="+direccion_r+
                                        "&importe="+importe +
                                        "&fpago_importe="+fpago_importe +
                                        "&comision="+comision +
                                        "&fpago_comision="+fpago_comision +
                                        "&pagador_comision="+pagador_comision +
                                        "&cod_moneda="+cod_moneda+
                                        "&cod_filial="+cod_filial+
                                        "&idcuentapersona="+idcuentapersona;
                                    req2.open("GET",url,true);
                                    req2.send(null);
                                    window.alert('¡¡SE REALIZO EL GIRO CON EXITO!!');
                                    document.f1.submit();
                                    window.location="SReciboGiro";
                                }else{
                                    window.alert('¡¡NO SE PUEDE REALIZAR EL GIRO!!');
                                }
                            }
                        }
                    }
                }
            }

            function detalleEmisor() {
                this.document.getElementById('detalle_cuenta').style.overflowY='auto';
                this.document.getElementById('detalle_cuenta').style.height='150px';
                var cod_moneda = document.f1.moneda[document.f1.moneda.selectedIndex].value;
                var idpersona_e = document.getElementById('Eidpersona').value;
                if (window.XMLHttpRequest) {
                    req2 = new XMLHttpRequest();
                }
                else if (window.ActiveXObject) {
                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2!=null){
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SBuscarCuenta?idpersona_e="+idpersona_e+"&cod_moneda="+cod_moneda;
                    req2.open("GET",url,true);
                    req2.onreadystatechange = procesarRes;
                    req2.send(null);
                }
            }

            function procesarRes(){
                contenido = document.getElementById('detalle_cuenta');
                contenido.innerHTML="Cargando los datos...";
                if (req2.readyState==4 && req2.status==200) {
                    contenido.innerHTML = req2.responseText;
                }
            }

            function efectivo(){
                this.document.getElementById('detalle_cuenta').innerHTML="";
                this.document.getElementById('detalle_cuenta').style.overflowY='';
                this.document.getElementById('detalle_cuenta').style.height='';
            }

            function porcuenta(){
                detalleEmisor();
            }

            function calculo_comision(){
                // ********* CALCULANDO EL 1.5 % DEL MONTO ********
                var valor_comision =document.getElementById('p_comision').value
                valor_comision = valor_comision.replace(/,/gi, "")
                if(valor_comision>100){window.alert('NO PUEDE SER MAYOR QUE 100%');
                    document.getElementById('p_comision').value=1.50;
                    calulo_gironeto();
                }
                var valor =document.getElementById('monto').value
                valor = valor.replace(/,/gi, "")
                var res =parseFloat (valor)*parseFloat (valor_comision)/100
                res=res.toFixed(2);
                var Sres =""+res;
                if(document.getElementById('Icomision').checked){
                    this.document.getElementById('monto_comision').value=currencyFormat2(Sres,',','.');
                } else{this.document.getElementById('monto_comision').innerHTML="";}
                this.document.getElementById('simbolo1').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo2').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo3').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
            }

            function calculo_comision2(){
                // ********* CALCULANDO EL S/ 5.00 DEL MONTO MINIMO ********
                var monto_comision =document.getElementById('monto_comision').value
                monto_comision = monto_comision.replace(/,/gi, "")
                var valor =document.getElementById('monto').value
                valor = valor.replace(/,/gi, "")
                var res =(parseFloat (monto_comision)*100)/parseFloat (valor)
                res=res.toFixed(2);
                var Sres =""+res;
                if(document.getElementById('Icomision').checked){
                    this.document.getElementById('simbolo1').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                    this.document.getElementById('p_comision').value=currencyFormat2(Sres,',','.');
                } else{
                    this.document.getElementById('p_comision').value="";
                }
                this.document.getElementById('simbolo1').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo2').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo3').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
            }

            function comision(){
                if(document.getElementById('Icomision').checked){
                    this.document.getElementById('p_comision').disabled='';
                    this.document.getElementById('monto_comision').disabled='';
                    this.document.getElementById('usuariop1').checked=true;
                    this.document.getElementById('formap1').checked=true;
                    calculo_comision2();
                    calulo_gironeto();
                    this.document.getElementById('simbolo1').style.visibility='';
                    this.document.getElementById('tr_usuariop').style.visibility='';
                    this.document.getElementById('tr_formap').style.visibility='';
                }else{
                    this.document.getElementById('p_comision').disabled=true;
                    this.document.getElementById('monto_comision').disabled=true;
                    calulo_gironeto();
                    this.document.getElementById('monto_comision').value="5.00";
                    this.document.getElementById('simbolo1').style.visibility='hidden';
                    this.document.getElementById('tr_usuariop').style.visibility='hidden';
                    this.document.getElementById('tr_formap').style.visibility='hidden';
                }
            }

            function rpemisor(){
                this.document.getElementById('tr_formap').style.visibility='';
            }

            function rpreceptor(){
                this.document.getElementById('tr_formap').style.visibility='hidden';
            }

            function calulo_gironeto(){
                var check;
                if(document.getElementById('Icomision').checked){check='ACTIVO';}else{check='INACTIVO';}
                var i;
                for (i=0;i<document.f1.usuariop.length;i++){
                    if (document.f1.usuariop[i].checked)
                        break;
                }
                var usp = document.f1.usuariop[i].value;
                var j;
                for (j=0;j<document.f1.formap.length;j++){
                    if (document.f1.formap[j].checked)
                        break;
                }
                var forp = document.f1.formap[j].value;
                if(check=='ACTIVO'){
                    if(usp=='PEMISOR'){
                        if(forp=='EFECTIVO'){
                            this.document.getElementById('giro_neto').value=document.getElementById('monto').value;
                            var valor =document.getElementById('monto').value;
                            valor = valor.replace(/,/gi, "");
                            var valor1 =document.getElementById('monto_comision').value;
                            valor1 = valor1.replace(/,/gi, "");
                            var res =parseFloat (valor)+parseFloat(valor1);
                            res=res.toFixed(2);
                            var Sres =""+res;
                            this.document.getElementById('total').value=currencyFormat2(Sres,',','.');
                        } else {
                            this.document.getElementById('total').value=document.getElementById('monto').value;
                            var valor =document.getElementById('monto').value;
                            valor = valor.replace(/,/gi, "");
                            var valor1 =document.getElementById('monto_comision').value;
                            valor1 = valor1.replace(/,/gi, "");
                            var res =parseFloat (valor)-parseFloat(valor1);
                            res=res.toFixed(2);
                            var Sres =""+res;
                            this.document.getElementById('giro_neto').value=currencyFormat2(Sres,',','.');
                        }
                    }else{
                        this.document.getElementById('giro_neto').value=document.getElementById('monto').value
                        this.document.getElementById('total').value=document.getElementById('monto').value
                    }
                }else{
                    // ********* SIN COMISION ********
                    this.document.getElementById('giro_neto').value=document.getElementById('monto').value
                    this.document.getElementById('total').value=document.getElementById('monto').value
                }
            }
            
            function actmoneda(){
                this.document.getElementById('simbolo1').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo2').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                this.document.getElementById('simbolo3').innerHTML= document.f1.moneda[document.f1.moneda.selectedIndex].label;
                efectivo();
            }

            var Saldo=-1;
            function cuentaSaldo(n){
                Saldo=n;
            }

            function extornar(idReg,t){
                Dialog.confirm($('login').innerHTML,
                {   className:"alphacube",
                    width:400,
                    okLabel: "login",
                    title: "Autorizar Usuario",
                    cancelLabel: "cancel",
                    onOk:function(){
                        var user =document.getElementById('user').value
                        var pass =document.getElementById('passwd').value
                        document.getElementById('res').innerHTML='';
                        Autorizar(user,pass);
                        window.alert('¡¡ DATOS ENVIADOS !!');
                        if(document.getElementById('res').innerHTML==1){
                            Aut = true;
                            sExtornar(idReg,t)
                            window.alert('¡¡SE REALIZO EL EXTORNO CON EXITO!!');
                            document.f1.submit();
                            return true;
                        }else{
                            $('login_error_msg').innerHTML='Usuario o Contrase&ntilde;a incorrecto';
                            $('login_error_msg').show(); Windows.focusedWindow.updateHeight();
                            new Effect.Shake(Windows.focusedWindow.getId());
                            return false;
                        }
                    }
                });
            }

            var req2;
            function sExtornar(id,tipo) {
                if (window.XMLHttpRequest) {
                    req2 = new XMLHttpRequest();
                } else if (window.ActiveXObject) {
                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2!=null){
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SExtornoOp?id="+id+"&tipo="+tipo;
                    req2.open("GET",url,true);
                    req2.send(null);
                }
            }

            function Autorizar(login,contrasenia) {
                if (window.XMLHttpRequest) {
                    req2 = new XMLHttpRequest();
                } else if (window.ActiveXObject) {
                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2!=null){
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SAutorizarUsuario?login="+login+"&contrasenia="+contrasenia;
                    req2.open("GET",url,true);
                    req2.onreadystatechange = procesar1;
                    req2.send(null);
                }
            }

            function procesar1(){
                contenido = document.getElementById('res');
                contenido.innerHTML="Cargando los datos...";
                contenido.innerHTML="";
                if (req2.readyState==4 && req2.status==200) {
                    contenido.innerHTML = req2.responseText;
                }
            }
        </script>
    </head>
    <body onload="document.getElementById('Ecategoria').focus();">
        <%@include file="../common/header.jsp" %>
        <%
                    request.setAttribute("idmenu", "20110228202911538690");
        %>
        <div id="login" style="display:none">
            <p>
                <span id='login_error_msg' class="login_error" style="display:none;font-size:15px;">&nbsp;</span>
            </p>
            <div style="clear:both">
            </div>
            <p>
                <span class="login_label">Usuario</span>
                <span class="login_input">
                    <input type="text" id="user"/>
                </span>
            </p>
            <div style="clear:both"></div>
            <p>
                <span class="login_label">Contrase&ntilde;a</span>
                <span class="login_input">
                    <input type="password" id="passwd"/>
                </span>
            </p>
            <div style="clear:both">
            </div>
            <div id="res" style="display:none">
            </div>
        </div>
        <div id="content">
            <div id="sidebar">
                <div id="menu">
                    <%@include file="../common/menu.jsp" %>
                </div>
                <div id="login" class="boxed">
                    <h2 class="title">Cuentra del cliente</h2>
                    <div class="content">
                        <form id="form1" method="post" action="principal.htm">
                            <fieldset>
                                <input id="inputsubmit1" type="submit" name="inputsubmit1" value="Salir" />
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
            <div id="main">
                <div id="welcome" class="post">
                    <h2 class="title">MODULO DE EMISION DE GIROS</h2>
                    <div class="story">
                        <form id="f1" name="f1" method="post" action="">
                            <table border="0" width="100%">
                                <tr>
                                    <td width="45%">
                                        <fieldset>
                                            <legend><b>DATOS DEL EMISOR</b></legend>
                                            <table border='0' width='100%'>
                                                <tr>
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Categoria&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <%
                                                                    String er = "EF";
                                                                    List result = d.findAll("from TCategoriaPersona");
                                                                    Iterator it4 = result.iterator();
                                                                    int j = 0;
                                                                    String check = "onclick=\"juridica('E')\"";
                                                                    while (it4.hasNext()) {
                                                                        if (j == 0) {
                                                                            check = "checked onclick=\"natural('E')\"";
                                                                        } else {
                                                                            check = "onclick=\"juridica('E')\"";
                                                                        }
                                                                        TCategoriaPersona cate = (TCategoriaPersona) it4.next();
                                                                        out.println(cate.getDescripcion() + "<input type='radio' name='Ecategoria' id='Ecategoria' value='" + cate.getIdcategoriapersona() + "' " + check + "  />");
                                                                        j++;
                                                                    }
                                                        %>
                                                    </td>
                                                </tr>
                                                <tr style='display:none'>
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>idpersona</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id="Eidpersona" type='hidden' name="Eidpersona"/>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_dni">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>D.N.I&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Edni' type='text' name='Edni' onkeypress='return soloNumeroTelefonico(event);' maxlength="8" onblur="buscarpersona('<%=er%>')" /><font color='red'>&nbsp;</font>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_ruc">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>R.U.C&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input disabled="true" id='Eruc' type='text' name='Eruc' onkeypress='return soloNumeroTelefonico(event);' maxlength="11" onblur="buscarpersona('<%=er%>') " /><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_nombres">
                                                    <td align='right' id="Etd_nombres">
                                                        <font color="#385B88" style="font-size:12px"><b> Nombres&nbsp;</b></font>
                                                    </td>
                                                    <td align='right' id="Etd_razonsocial" style='display:none'>
                                                        <font color="#385B88" style="font-size:12px"><b>Razon Social</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Enombres' type='text' name='Enombres' maxlength="50" /><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_apellidos">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Apellidos&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Eapellidos' type='text' name='Eapellidos' maxlength="50" onblur="buscarpersona('EH') "/><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr >
                                                    <td  colspan='2'>
                                                        <b>&nbsp;</b>
                                                    </td>
                                                </tr>
                                                <tr  id="Etr_email">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Email&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Eemail' type='text' name='Eemail' maxlength="50"/>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_ubigeo">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Ubigeo&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Eubigeo' type='text' name='Eubigeo' onkeypress='return soloNumeroTelefonico(event);' maxlength="10"/><font color='red'>&nbsp;</font>
                                                    </td>
                                                </tr>
                                                <tr id="Etr_telefono">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Tel&eacute;fono&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Etelefono' type='text' name='Etelefono' onkeypress='return soloNumeroTelefonico(event);' maxlength="10" />
                                                    </td>
                                                </tr>
                                                <tr id="Etr_celular">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Celular&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Ecelular' type='text' name='Ecelular' onkeypress='return soloNumeroTelefonico(event);' maxlength="12" />
                                                    </td>
                                                </tr>
                                                <tr id="Etr_direccion">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Direccion&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Edireccion' type='text' name='Edireccion' maxlength="100"/>
                                                    </td>
                                                </tr>
                                            </table>
                                            <br>
                                        </fieldset>
                                    </td>
                                    <td width="10%">
                                        &nbsp;
                                    </td>
                                    <td width="45%">
                                        <fieldset>
                                            <legend><b>DATOS DEL RECEPTOR</b></legend>
                                            <table border='0' width='100%'>
                                                <tr>
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Categoria&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <%
                                                                    String Rer = "RF";
                                                                    List Rresult = d.findAll("from TCategoriaPersona");
                                                                    Iterator it4R = Rresult.iterator();
                                                                    int jR = 0;
                                                                    String checkR = "onclick=\"juridica('R')\"";
                                                                    while (it4R.hasNext()) {
                                                                        if (jR == 0) {
                                                                            checkR = "checked onclick=\"natural('R')\"";
                                                                        } else {
                                                                            checkR = "onclick=\"juridica('R')\"";
                                                                        }
                                                                        TCategoriaPersona cate = (TCategoriaPersona) it4R.next();
                                                                        out.println(cate.getDescripcion() + "<input type='radio' name='Rcategoria' id='Rcategoria' value='" + cate.getIdcategoriapersona() + "' " + checkR + "  />");
                                                                        jR++;
                                                                    }
                                                        %>
                                                    </td>
                                                </tr>
                                                <tr style='display:none'>
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>idpersona</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id="Ridpersona" type='hidden' name="Ridpersona" />
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_dni">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>D.N.I&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rdni' type='text' name='Rdni' onkeypress='return soloNumeroTelefonico(event);' maxlength="8" onblur="buscarpersona('<%=Rer%>')" /><font color='red'>&nbsp;</font>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_ruc">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>R.U.C&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input disabled="true" id='Rruc' type='text' name='Rruc' onkeypress='return soloNumeroTelefonico(event);' maxlength="11" onblur="buscarpersona('<%=Rer%>') " /><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_nombres">
                                                    <td align='right' id="Rtd_nombres">
                                                        <font color="#385B88" style="font-size:12px"><b> Nombres&nbsp;</b></font>
                                                    </td>
                                                    <td align='right' id="Rtd_razonsocial" style='display:none'>
                                                        <font color="#385B88" style="font-size:12px"><b>Razon Social</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <div id="detalle" style='display:none'></div>
                                                        <input id='Rnombres' type='text' name='Rnombres' maxlength="50" /><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_apellidos">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Apellidos&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rapellidos' type='text' name='Rapellidos' maxlength="50" onblur="buscarpersona('RH')"/><font color='red'>*</font>
                                                    </td>
                                                </tr>
                                                <tr >
                                                    <td colspan='2'>
                                                        <b>&nbsp;</b>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_email">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Email&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Remail' type='text' name='Remail' maxlength="50"/>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_ubigeo">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Ubigeo&nbsp;</b></font>

                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rubigeo' type='text' name='Rubigeo' onkeypress='return soloNumeroTelefonico(event);' maxlength="10"/><font color='red'>&nbsp;</font>
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_telefono">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Tel&eacute;fono&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rtelefono' type='text' name='Rtelefono' onkeypress='return soloNumeroTelefonico(event);' maxlength="10" />
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_celular">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Celular&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rcelular' type='text' name='Rcelular' onkeypress='return soloNumeroTelefonico(event);' maxlength="12" />
                                                    </td>
                                                </tr>
                                                <tr id="Rtr_direccion">
                                                    <td align='right'>
                                                        <font color="#385B88" style="font-size:12px"><b>Direccion&nbsp;</b></font>
                                                    </td>
                                                    <td align='left'>
                                                        <input id='Rdireccion' type='text' name='Rdireccion' maxlength="100"/>
                                                    </td>
                                                </tr>
                                            </table>
                                            <br>
                                        </fieldset>
                                    </td>
                                </tr>
                            </table>
                            <fieldset>
                                <legend><b>DATOS DEL GIRO</b></legend>
                                <table border="0" cellpadding="10" cellspacing="10" width="100%">
                                    <tr>
                                        <td align="left">
                                            <font color="#385B88" style="font-size:12px"><b>CONDICION DEL EMISOR&nbsp;&nbsp;&nbsp;&nbsp;</b></font>
                                            <input id='grupo' type='text' name='grupo' style='color:red; font-weight:bold ;background:transparent' readonly='true' value="" size="10" />
                                        </td>
                                        <td align="right">
                                            <font color="#385B88" style="font-size:12px"><b>RECEPCI&Oacute;N :</b></font>
                                            <select name="filial_recepcion" id="filial_recepcion" >
                                                <%
                                                            result = d.findAll("from TFilial");
                                                            Iterator it3 = result.iterator();
                                                            while (it3.hasNext()) {
                                                                TFilial filial_recept = (TFilial) it3.next();
                                                                out.println("<option value='" + filial_recept.getCodFilial() + "' >" + filial_recept.getNombre() + "</option>");
                                                            }
                                                %>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="left">
                                            <font color="#385B88" style="font-size:12px">MONTO A GIRAR</font>
                                            <select name="moneda" style="font-size:20px" onchange="actmoneda()" >
                                                <%
                                                            result = d.findAll("from TMoneda where estado ='ACTIVO'");
                                                            Iterator itMONEDA = result.iterator();
                                                            String sel = "";
                                                            while (itMONEDA.hasNext()) {
                                                                TMoneda Moneda = (TMoneda) itMONEDA.next();
                                                                if (Moneda.getCodMoneda().equals("PEN")) {
                                                                    sel = "selected";
                                                                } else {
                                                                    sel = "";
                                                                }
                                                                out.println("<option label='" + Moneda.getSimbolo() + "' value='" + Moneda.getCodMoneda() + "' " + sel + ">" + Moneda.getSimbolo() + "</option>");
                                                            }
                                                %>
                                            </select>
                                            <input id="monto" type="text" style="font-size:20px;width:140px;text-align:right" name="monto" value="0.00" onkeypress="return validar(event);" onblur="this.value=eedisplayFloatNDTh(eeparseFloatTh(this.value),2);calculo_comision2();calulo_gironeto();"  onfocus="this.select();" />
                                        </td>
                                        <td align="right">
                                            <font color="#385B88" style="font-size:12px"><b>EFECTIVO :</b></font>
                                            <input type="radio" name="forpago" id="forpago1" value="EFECTIVO" checked onclick="efectivo();"/>
                                            <font color="#385B88" style="font-size:12px"><b>CARGO A CUENTA:</b></font>
                                            <input type="radio" name="forpago" id="forpago2" disabled value="CUENTA" onclick="porcuenta();" />
                                        </td>
                                    <tr>
                                        <td align="left">
                                            <table border="0 " cellpadding="10" cellspacing="10" width="100%">
                                                <tr>
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px">COBRAR COMISION <b>
                                                                <input id="p_comision" type="text" style="font-size:12px;width:50px;text-align:right" name="p_comision" value="1.50" onkeypress="return validar(event);" onfocus="this.select();" onblur="this.value=eedisplayFloatNDTh(eeparseFloatTh(this.value),2);calculo_comision();calulo_gironeto();" disabled />
                                                                %
                                                            </b>
                                                        </font>
                                                        <input type='checkbox' id='Icomision' name='Icomision' onclick='comision()' />
                                                    </td>
                                                    <td>
                                                        <table border="0" cellspacing="5">
                                                            <tr>
                                                                <td>
                                                                    <div id="simbolo1" style="visibility:hidden;font-size:15px;color:#000000;font-weight: bold;"></div>
                                                                </td>
                                                                <td>
                                                                    <div id="div_comision" style="font-size:15px;color:#000000;font-weight: bold;"></div>
                                                                    <input id="monto_comision" type="text" style="font-size:12px;width:50px;text-align:right" name="monto_comision" value="5.00" onkeypress="return validar(event);" onfocus="this.select();" onblur="this.value=eedisplayFloatNDTh(eeparseFloatTh(this.value),2);calculo_comision2();calulo_gironeto();" disabled />
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr id="tr_usuariop" style="visibility:hidden">
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>EMISOR:</b></font>
                                                        <input type="radio" name="usuariop" id="usuariop1" value="PEMISOR" checked onclick='rpemisor();calulo_gironeto();'/>
                                                    </td>
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>RECEPTOR:</b></font>
                                                        <input type="radio" name="usuariop" id="usuariop2" value="PRECEPTOR" onclick='rpreceptor();calulo_gironeto();' />
                                                    </td>
                                                </tr>
                                                <tr id="tr_formap" style="visibility:hidden">
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>EFECTIVO:</b></font>
                                                        <input type="radio" name="formap" id="formap1" value="EFECTIVO" checked onclick="calulo_gironeto()"/>
                                                    </td>
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>DESCONTAR:</b></font>
                                                        <input type="radio" name="formap" id="formap2" value="DESCONTAR" onclick="calulo_gironeto()"/>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td align="right">
                                            <table border="0" cellspacing="5">
                                                <tr>
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>GIRO NETO </b></font>
                                                    </td>
                                                    <td id="simbolo2" style="font-size:20px;color:#018d00" >
                                                    </td>
                                                    <td>
                                                        <input id="giro_neto" type="text" style="font-size:20px;width:140px;color:#018d00;background:transparent;text-align:right" readonly='true' name="giro_neto" value="" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <font color="#385B88" style="font-size:12px"><b>TOTAL </b></font>
                                                    </td>
                                                    <td id="simbolo3" style="font-size:20px;color:#E08934">
                                                    </td>
                                                    <td>
                                                        <input id="total" type="text" style="font-size:20px;width:140px;color:#E08934;background:transparent;text-align:right" readonly='true' name="total" value="" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div id="detalle_cuenta" ></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" align="center">
                                            <input type="button" onclick="procesar();" value="PROCESAR" />
                                        </td>
                                    </tr>
                                </table>
                            </fieldset>
                        </form>
                        <br>
                        <br>
                        <fieldset>
                            <table border="0" class='tabla' width="100%" cellpadding="5" cellspacing="5">
                                <tr>
                                    <th width="17%" align="center" style="font-size:10px;color:#000000">Fecha</th>
                                    <th width="22%" align="center" style="font-size:10px;color:#000000">N&deg; OP</th>
                                    <th width="16%" align="center" style="font-size:10px;color:#000000">Operacion</th>
                                    <th width="16%" align="center" style="font-size:10px;color:#000000">Monto</th>
                                    <th width="16%" align="center" style="font-size:10px;color:#000000">Moneda</th>
                                    <th width="19%" align="center" style="font-size:10px;color:#000000">&nbsp;</th>
                                    <th width="1%" align="center" style="font-size:10px;color:#000000">&nbsp;</th>
                                </tr>
                            </table>
                            <div id='extorno' style='overflow-y:auto; height:100px;width:100%' >
                                <table border="0" class='tabla' width="100%" cellpadding="2" cellspacing="2">
                                    <%
                                                String hql = "from TRegistroGiro where TOperacion.TPersonaCaja.idpersonacaja='" + session.getAttribute("USER_ID_PERSONA_CAJA") + "'  AND TOperacion.TTipoOperacion.codigoTipoOperacion ='TIPC5' AND estado='ESPERA' AND TOperacion.estado='ACTIVO' AND fecha like '" + DateUtil.getDate(new Date()) + "%' order by fecha desc";
                                                List resultOp = d.findAll(hql);
                                                Iterator itOp = resultOp.iterator();
                                                Double Monto = 0.00;
                                                String Tipo = "TIPC5";
                                                int k = 0;
                                                while (itOp.hasNext()) {
                                                    TRegistroGiro opreg = (TRegistroGiro) itOp.next();
                                                    Monto = opreg.getImporte().doubleValue() + opreg.getComision().doubleValue();
                                                    if (k % 2 == 0) {
                                                        out.println("<tr class='modo1'>");
                                                    } else {
                                                        out.println("<tr class='modo2'>");
                                                    }
                                    %>
                                    <td width="20%" style="font-size:10px;"><%=opreg.getFecha()%></td>
                                    <td width="20%" style="font-size:10px;"><%=opreg.getTOperacion().getNumeroOperacion()%></td>
                                    <td width="20%" style="font-size:10px;"><%=opreg.getTOperacion().getTTipoOperacion().getNombre()%></td>
                                    <td width="20%" style="font-size:10px;"><%=fm.formatMoneda(Monto)%></td>
                                    <td width="20%" style="font-size:10px;"><%=opreg.getTOperacion().getTMoneda().getNombre()%></td>
                                    <td width="19%" style="font-size:10px; text-align: right;"><input type="button" value="Extornar" onclick="extornar('<%=opreg.getIdregistro().toString()%>','<%=Tipo%>')" /></td>
                                        <% out.println("</tr>");
                                                        k++;
                                                    }%>
                                </table>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </div>
        </div>
        <%@include file="../common/footer.jsp" %>
    </body>
</html>
