<%--
 Document : admincuenta
 Created on : 01/09/2010, 04:41:24 PM
 Author  : roger
--%>

<%@page contentType="text/html" pageEncoding="UTF-8" session="true"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" href="./images/favicon.ico" />
        <title>FinanceBank</title>
        <meta name="keywords" content="FinanceBank" />
        <meta name="description" content="Sistema financiero" />
        <link href="default.css" rel="stylesheet" type="text/css" />
        <link href='css/tabla.css' rel='stylesheet' type='text/css' />
        <script type="text/javascript" src="js/prototype.js"> </script>
        <script type="text/javascript" src="js/effects.js"> </script>
        <script type="text/javascript" src="js/window.js"> </script>
        <script type="text/javascript" src="js/debug.js"> </script>
        <link href="css/themes/default.css" rel="stylesheet" type="text/css"/>
        <link href="css/themes/alert.css" rel="stylesheet" type="text/css"/>
        <link href="css/themes/alphacube.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="js/validacion.js"> </script>
        <script type="text/javascript" src="js/calendar/popcalendar.js"> </script>
        <script type="text/javascript">
            //capitalizar
            var reqCap;
            function capitalizar(cuenta){
                if(cuenta==""){
                    return;
                }
                var m=document.getElementById('txtC').value;
                m=eedisplayFloatNDTh(eeparseFloatTh(m),2);
                document.getElementById('txtC').value=m;
                var answer = window.confirm ("SE HA CORREGIDO EL MONTO A CAPITALIZAR \n ¿ESTA SEGURO QUE DESEA CONTINUAR?");
                if (!answer){
                    return;
                }
                reqCap = null;
                if (window.XMLHttpRequest) {
                    reqCap = new XMLHttpRequest();
                } else if (window.ActiveXObject) {
                    reqCap = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(reqCap!=null){
                    var answer = window.confirm ("¿ESTA SEGURO QUE DESEA CAPITALIZAR LA CUENTA?");
                    if (answer){
                        reqCap.onreadystatechange = procesarCapitalizar;
                        var PATH = "<%= request.getContextPath()%>";
                        var url = PATH + "/SActualizarCuentas?idcuenta="+cuenta+"&m="+m;;
                        reqCap.open("GET",url,true);
                        reqCap.send(null);
                    }
                }
            }

            function procesarCapitalizar(){
                contenido = document.getElementById('divesperarCap');
                contenido.innerHTML="Cargando los datos...";
                if (reqCap.readyState==4 && reqCap.status==200) {
                    contenido.innerHTML = reqCap.responseText;
                    if(document.getElementById("divesperarCap").innerHTML=="OK"){
                        window.alert("LA CUENTA SE CAPITALIZÓ SATISFACTORIAMENTE");
                        document.frmActualizar.submit();
                    }else{
                        window.alert("ERROR AL CAPITALIZAR LA CUENTA, RECARGAR EL SISTEMA");
                        document.frmActualizar.submit();
                    }
                }
            }
        </script>
        <script type="text/javascript">
            function activarcuentaestado(indice){
                if (document.getElementById("fechaEstCuen").value!=""){
                    var idcuenta="",fecha="";
                    idcuenta=document.getElementById("tdIdCuenPersona"+indice).innerHTML
                    fecha=document.getElementById("fechaEstCuen").value;
                    document.frmIrEstadoCuenta.action="estadodecuenta.htm?idcuenta="+idcuenta+"&fecha="+fecha;
                    document.frmIrEstadoCuenta.submit();
                }else{
                    window.alert("INGRESE FECHA DE INICIO PARA EL ESTADO DE CUENTA");
                }
            }
        </script>
        <script type="text/javascript">
            var req;
            <%
                     String s = DateUtil.getNOW_S();
            %>
                function mostrarbotoncreate(indice) {
                    document.getElementById("txtind").value=indice;
                    var tipo=document.getElementById("tdtipocuenta"+indice).innerHTML;
                    var numcuenta,miinteres,idMoney,IdCuenPersona,mon;
                    var saldo,saldo1;
                    var fec=document.getElementById("tdFechaCap"+indice).innerHTML;
                    numcuenta=document.getElementById("tdNumCuenta"+indice).innerHTML;
                    miinteres=document.getElementById("tdInteres"+indice).innerHTML;
                    idMoney=document.getElementById("tdIdMoney"+indice).innerHTML;
                    IdCuenPersona=document.getElementById("tdIdCuenPersona"+indice).innerHTML;
                    saldo=document.getElementById("tdSaldoCuenta"+indice).innerHTML;
                    var sa=parseFloat(saldo);
                    saldo=eedisplayFloatNDTh(eeparseFloatTh(saldo),2);
                    saldo1=document.getElementById("tdSaldoCuenta1"+indice).innerHTML;
                    var sa1=parseFloat(saldo1);
                    saldo1=eedisplayFloatNDTh(eeparseFloatTh(saldo1),2);
                    var monint=0;
                    if(isFinite(sa)&&isFinite(sa1)){
                        monint=sa-sa1;
                    }
                    if(idMoney=="PEN")
                        mon="S/.";
                    else if(idMoney=="USD")
                        mon="&#36;";
                    else
                        mon="&#8364;";
                    document.getElementById("divcuenta").innerHTML="<fieldset id='fielCuen' style='border-width:3px'>"+
                        "<legend id='legcuenta'><b> "+tipo+":"+numcuenta+"</b></legend>"+
                        "<table id='tablecuenta'>"+
                        "<tr>"+
                        "<td style='font-weight:bold' colspan='4'>&nbsp;ACTUALIZA EL MONTO FINAL SOLO CUANDO CORRESPONDA UN CÁLCULO REAL.</td>"+
                        "</tr>"+
                        "<tr>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b>MONTO DISPONIBLE:</b></font></td>"+
                        "<td><input type='text' id='txtNumCuentaDep' name='txtNumCuentaDep' value='"+saldo1+"' disabled style='font-weight:bold;color:black'/></td>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><input type='button' value='VER ANT.' onclick='verants(\""+IdCuenPersona+"\")'></font></td>"+
                        "<td>HOY: <%=s%> TASA INT. ACTUAL: "+miinteres+"</td>"+
                        "</tr>"+
                        "<tr>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b>MONTO DE INTERESES:</b></font></td>"+
                        "<td><input type='text' id='txtInteres' name='txtInteres' value='"+(monint)+"' style='font-weight:bold;color:black;width: 160px;' readonly/></td>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><input type='button' value='VER CALCULOS' onclick='vercals(\""+IdCuenPersona+"\")'></font></td>"+
                        "<td>FECHA DE CAPITALIZACI&Oacute;N: "+fec+"</td>"+
                        "</tr>"+
                        "<tr>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b>MONTO CAPITALIZABLE:</b></font></td>"+
                        "<td>Valor:<input type='text' id='txtC' name='txtC' value='"+(monint)+"' onkeypress='return solodecimales(event);' maxlenth='20' style='font-weight:bold;color:black;width:80px;'/></td>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b><input type='button' value='CAPITALIZAR...' onclick='capitalizar(\""+IdCuenPersona+"\")'></b></font></td>"+
                        "<td>-Poner el monto de diferencia.</td>"+
                        "</tr>"+
                        "<tr>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b>SALDO FINAL:</b>("+mon+" "+saldo+")</font></td>"+
                        "<td><font color='#E08934' style='font-size: 20px;'><b>"+mon+"</b></font><input type='text' id='txtImporteDep' name='txtImporteDep' value='"+saldo+"' onkeypress='return solodecimales(event);' /></td>"+
                        "<td><font color='#385b88' style='font-size: 12px;'><b><input type='button' name='cmdActualizar' id='cmdActualizar' value='Reajustar' onclick='actualizarCuentaF(\""+IdCuenPersona+"\");'></b></font></td>"+
                        "<td>Poner el monto que debe representar el Saldo Final.</td>"+
                        "</tr>"+
                        "<table>"+
                        "</fieldset>";
                }

                function procesarrrRespuesta(){
                    contenido = document.getElementById('divcuenta');
                    contenido.innerHTML="Cargando los datos...";
                    if (req.readyState==4 && req.status==200) {
                        contenido.innerHTML = req.responseText;
                    }
                }
        </script>
        <script type="text/javascript">
            var da1,da2;
            var req4;
            function vercuenta(){
                document.getElementById("");
                document.getElementById("divcuenta").innerHTML="";
                document.getElementById("txtTempSelTipB").value=document.getElementById("selTipoBus").value;
                document.getElementById("txtTempdataB").value=document.getElementById("txtBuscar").value;
                document.getElementById("divcuenta").innerHTML="";
                var contenido, tipoBusqueda="";
                contenido=document.getElementById("txtBuscar").value;
                tipoBusqueda=document.getElementById("selTipoBus").value;
                if(tipoBusqueda=='0'){
                    return;
                }
                document.getElementById('divlistPerCuentas').innerHTML="CARGANDO ...<img alt='Cargando ...' src='images/ajax/ajax-loader1.gif'/>";
                req4 = null;
                if (window.XMLHttpRequest) {
                    req4 = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    req4 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req4!=null){
                    req4.onreadystatechange = procesarRespuesta3;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SDepositoRetiro2?contenido="+contenido+"&tipoBusqueda="+tipoBusqueda;
                    req4.open("GET",url,true);
                    req4.send(null);
                }
            }

            function mostrarcuentadetalle(ind) {
                document.getElementById("divcuenta").innerHTML="";
                var contenido, tipoBusqueda="";
                contenido=document.getElementById("txtBuscar").value;
                tipoBusqueda=document.getElementById("selTipoBus").value;
                if (tipoBusqueda=="NUMERO DE CUENTA"){
                    contenido=document.getElementById("ttdNumCuenta"+ind).innerHTML;
                }else if (tipoBusqueda=="DNI" || tipoBusqueda=="NOMBRE" || tipoBusqueda=="APELLIDO"){
                    contenido=ind;
                }else if (tipoBusqueda=="RUC"){
                    contenido=ind;
                }
                req2 = null;
                if (window.XMLHttpRequest) {
                    req2 = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2!=null){
                    req2.onreadystatechange = procesarRespuesta2;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SDepositoRetiro?contenido="+contenido+"&tipoBusqueda="+tipoBusqueda;
                    req2.open("GET",url,true);
                    req2.send(null);
                }
            }

            function procesarRespuesta2(){
                contenido = document.getElementById('tableMiscuentas');
                contenido.innerHTML="Cargando los datos...";
                if (req2.readyState==4 && req2.status==200) {
                    contenido.innerHTML = req2.responseText;
                    var tamTabla;
                    tamTabla=document.getElementById("tablamiscuentas").rows.length;
                    if(tamTabla>=6){
                        contenido = document.getElementById('tableMiscuentas').style.overflow="auto";
                        contenido = document.getElementById('tableMiscuentas').style.height="300px";
                    }else{
                        contenido = document.getElementById('tableMiscuentas').style.overflow="";
                        contenido = document.getElementById('tableMiscuentas').style.height="";
                    }
                }
            }

            function procesarRespuesta3(){
                contenido = document.getElementById('divlistPerCuentas');
                contenido.innerHTML="Cargando los datos...<img alt='Cargando ...' src='images/ajax/ajax-loader1.gif' style='display: none'/>";
                if (req4.readyState==4 && req4.status==200) {
                    contenido.innerHTML = req4.responseText;
                    var tamTabla;
                    tamTabla=document.getElementById("tablapersonas").rows.length;
                    if(tamTabla>=7){
                        contenido = document.getElementById('divlistPerCuentas').style.overflow="auto";
                        contenido = document.getElementById('divlistPerCuentas').style.height="320px";
                    }else{
                        contenido = document.getElementById('divlistPerCuentas').style.overflow="";
                        contenido = document.getElementById('divlistPerCuentas').style.height="";
                    }
                }
            }
        </script>
        <script language="javascript" type="text/javascript">
            var rant;
            function verants(idc0){
                rant = null;
                if (window.XMLHttpRequest) {
                    rant = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    rant = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(rant!=null){
                    rant.onreadystatechange = procesarRespuestaAnt;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SUpdateMDisp?idcuenta="+idc0+"&tiny=a";
                    rant.open("GET",url,true);
                    rant.send(null);
                }
            }

            function procesarRespuestaAnt(){
                var contenidox = document.getElementById('ver');
                contenidox.innerHTML="Cargando los datos...";
                if (rant.readyState==4 && rant.status==200) {
                    contenidox.innerHTML = rant.responseText;
                }
            }

            var rcal;
            function vercals(idc1){
                rcal = null;
                if (window.XMLHttpRequest) {
                    rcal = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    rcal = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(rcal!=null){
                    rcal.onreadystatechange = procesarRespuestaCal;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SUpdateMDisp?idcuenta="+idc1+"&tiny=c";
                    rcal.open("GET",url,true);
                    rcal.send(null);
                }
            }

            function procesarRespuestaCal(){
                var contenidox = document.getElementById('ver');
                contenidox.innerHTML="Cargando los datos...";
                if (rcal.readyState==4 && rcal.status==200) {
                    contenidox.innerHTML = rcal.responseText;
                }
            }

            var req2x;
            function actualizarCuentaF(idc2){
                document.getElementById("tableReportx").innerHTML="NO";
                var nm=document.getElementById("txtImporteDep").value;
                if(!window.confirm("SU NUEVO VALOR SERÁ... "+nm)){
                    return
                }
                if (idc2==""){
                    window.alert("Error inicial, que verifique en el servicio de informática");
                }
                req2x = null;
                if (window.XMLHttpRequest) {
                    req2x = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    req2x = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2x!=null){
                    req2x.onreadystatechange = procesarRespuesta2x;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SUpdateMDisp?idcuenta="+idc2+"&nm="+nm;
                    req2x.open("GET",url,true);
                    req2x.send(null);
                }
            }

            function procesarRespuesta2x(){
                var contenidox = document.getElementById('tableReportx');
                contenidox.innerHTML="Cargando los datos...";
                if (req2x.readyState==4 && req2x.status==200) {
                    contenidox.innerHTML = req2x.responseText;
                    var tamTabla;
                    tamTabla=contenidox.innerHTML;
                    if(tamTabla=="OK"){
                        window.alert("SE HA ACTUALIZADO CORRECTAMENTE!!");
                    }else{
                        window.alert("Ha fallado la actualización");
                    }
                    document.frmadmincuenta.action="";
                    document.frmadmincuenta.submit();
                }
            }
        </script>
        <script language="javascript" type="text/javascript">
            function activeSpecialKey(e) {
                var whichCode = (window.Event) ? e.which : e.keyCode;
                if (whichCode == 13) vercuenta(); // Enter
            }

            function validartxtBusqueda(){
                var seltipo;
                seltipo=document.getElementById("selTipoBus").value;
                if(seltipo=='0'){
                    return;
                }
                if(seltipo=="NUMERO DE CUENTA"){
                    document.getElementById('txtestados').value="0";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='return soloNumeroTelefonico(event);' onkeyup='activeSpecialKey(event);' />";
                    document.getElementById("divlistPerCuentas").style.overflow="";
                }else if(seltipo=="DNI"){
                    document.getElementById('txtestados').value="0";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='return solonumeros(event);' onkeyup='activeSpecialKey(event);' maxlength='8' />";
                }else if(seltipo=="RUC"){
                    document.getElementById('txtestados').value="0";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='return solonumeros(event);' onkeyup='activeSpecialKey(event)'/>";
                }else if(seltipo=="NOMBRE"){
                    document.getElementById('txtestados').value="1";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='activeSpecialKey(event);' />";
                }else if(seltipo=="APELLIDO"){
                    document.getElementById('txtestados').value="1";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='activeSpecialKey(event);' />";
                }else if(seltipo=="(Seleccione Tipo Busqueda)"){
                    document.getElementById('txtestados').value="0";
                    document.getElementById("divtxtBuscar").innerHTML=" <input id='txtBuscar' type='text' name='txtBuscar' value='' onkeypress='activeSpecialKey(event);' />";
                }
                document.getElementById("divlistPerCuentas").innerHTML="";
                document.getElementById("divlistPerCuentas").style.height="0px";
                document.getElementById("tableMiscuentas").innerHTML="";
                document.getElementById("divcuenta").innerHTML="";
                document.getElementById("txtBuscar").focus();
            }
        </script>
        <script language="javascript" type="text/javascript">
            var req3;
            function registrarDepRet(){
                var TipTrans,tipoCuentah,NumCuentaDep, miIdPersona, miIdMoney,miImporte,miInteres,miIdCuenPersona;
                var nombreDeposit, apellidosDeposit,observacion,Importe,Knegativo,PCobroPF="",interesKnegativo="";
                var fechaCobroKneagativo="";
                TipTrans=document.getElementById("txtTipTrans").value;
                Importe=document.getElementById("txtImporteDep").value;
                Knegativo=document.getElementById("txtKnegativo").value;
                if(document.getElementById("txtCobroPF").value!==null)
                    PCobroPF=document.getElementById("txtCobroPF").value;
                if(TipTrans=="DEPOSITO" || TipTrans=="RETIRO"){
                    if(Importe!=""){
                        NumCuentaDep=document.getElementById("txtNumCuentaDep").value;
                        miIdPersona=document.getElementById("txidPersona").value;
                        miIdMoney=document.getElementById("txidMoney").value;
                        miImporte=document.getElementById("txtImporteDep").value;
                        miInteres=document.getElementById("txtInteres").value;
                        nombreDeposit=document.getElementById("txtNombreDep").value;
                        apellidosDeposit=document.getElementById("txtApellidoDep").value;
                        miIdCuenPersona=document.getElementById("txidCuentaPersona").value;
                        observacion=document.getElementById("txtaObservacion").value;
                        tipoCuentah=document.getElementById("txTipoCuenta").value;
                        var miNumCheque;
                        miNumCheque=document.getElementById("txtNumCheque").value;
                        interesKnegativo=document.getElementById("txtinteress").value;
                        fechaCobroKneagativo=document.getElementById("txtCobroKnegativo").value;
                        req3 = null;
                        if (window.XMLHttpRequest) {
                            req3 = new XMLHttpRequest();
                        }else if (window.ActiveXObject) {
                            req3 = new ActiveXObject("Microsoft.XMLHTTP");
                        }
                        if(req3!=null){
                            var rpta;
                            if(TipTrans=="DEPOSITO")
                                rpta="DEPOSITO";
                            else
                                rpta="RETIRO";
                            if(document.getElementById('chkKnegativo').checked==true && document.getElementById('txtinteress').value==""){
                                alert("Ingrese Interes para el prestamo");
                                document.frmadmincuenta.txtinteress.focus();
                                return;
                            }
                            var answer = window.confirm ("¿ESTA SEGURO QUE DESEA REGISTRAR "+rpta+"?");
                            if (answer){
                                req3.onreadystatechange = procesarrResspuesta;
                                var PATH = "<%= request.getContextPath()%>";
                                var url = PATH + "/SRegistrarDepositoRetiro?TipTrans="+TipTrans+"&NumCuentaDep="+
                                    NumCuentaDep+"&miIdPersonah="+miIdPersona+"&miIdMoney="+
                                    miIdMoney+"&miImporte="+miImporte+"&miInteres="+miInteres+
                                    "&nombreDeposit="+nombreDeposit+"&apellidosDeposit="+
                                    apellidosDeposit+"&miIdCuenPersona="+miIdCuenPersona+
                                    "&observacion="+observacion+"&Knegativo="+Knegativo+"&PCobroPF="+PCobroPF+
                                    "&miNumCheque="+miNumCheque+"&tipoCuentah="+tipoCuentah+
                                    "&interesKnegativo="+interesKnegativo+"&fechaCobroKneagativo="+fechaCobroKneagativo;
                                req3.open("GET",url,true);
                                req3.send(null);
                            }
                        }
                    }else{
                        window.alert("DEBE INGRESAR IMPORTE PARA LA TRANSACCION");
                        document.frmadmincuenta.txtImporteDep.focus();
                    }
                }else{
                    window.alert("Debe seleccionar el TIPO DE TRANSACCION (DEPOSITO o RETIRO)");
                }
            }

            function procesarrResspuesta(){
                contenido = document.getElementById('divRespuestaRegistro');
                contenido.innerHTML="Cargando los datos...";
                if (req3.readyState==4 && req3.status==200) {
                    contenido.innerHTML = req3.responseText;
                    var tipTrans;
                    tipTrans=document.getElementById('txtTipTrans').value;
                    var es;
                    es=document.getElementById("txtRespReg").value;
                    var van;
                    van=document.getElementById("txtExisteMontoCaja").value;
                    var vanPF;
                    vanPF=document.getElementById("txtVanPF").value;
                    if(van=="OK"){
                        if(es=="OK"){
                            if(vanPF==""){
                                if(tipTrans=="DEPOSITO"){
                                    window.alert("El DEPOSITO se ha realizado satisfactoriamente");
                                    document.frmiraticket.submit();
                                }else{
                                    window.alert("El RETIRO se ha realizado satisfactoriamente");
                                    document.frmiraticket.submit();
                                }
                            }else{
                                window.alert("La fecha de plazo fijo vence el :"+vanPF);
                            }
                        }else if (es=="NO HAY DINERO SUFICIENTE"){
                            window.alert("NO HAY DINERO SUFICIENTE EN LA CUENTA DEL CLIENTE");
                        }else{
                            window.alert("La TRANSACCION NO se pudo realizar, revise sus datos e intentelo de nuevo");
                        }
                    }else if(van=="NO HAY DINERO EN CAJA"){
                        window.alert("NO DISPONE DE DINERO EN CAJA EN ESTE TIPO DE MONEDA, PIDA UNA TRANSFERENCIA A LA BOVEDA O CAJERO");
                    }else{
                        window.alert("La TRANSACCION NO se pudo realizar, revise sus datos e intentelo de nuevo.");
                    }
                }
            }
        </script>
        <script language="javascript" type="text/javascript">
            var eeisus=0;
            var eetrue="VERDADERO";
            var eefalse="FALSO";
            var eedec=".";
            var eeth=",";
            var eedecreg=new RegExp("\\.","g");
            var eethreg=new RegExp(",","g");
            var eecurrencyreg=new RegExp("€","g");
            var eepercentreg=new RegExp("%","g");
            var fmtdaynamesshort=new Array("dom","lun","mar","mié","jue","vie","sáb");
            var fmtdaynameslong=new Array("domingo","lunes","martes","miércoles","jueves","viernes","sábado");
            var fmtmonthnamesshort=new Array("ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic");
            var fmtmonthnameslong=new Array("enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre");
            var fmtstrings=new Array(","," ","S/.","SOLES","€","/","$");
            var fmtdate6=new Array(34,33,25,2);
            var fmtdate7=new Array(25,2,33,35);
            var fmtdate8=new Array(25,2,33,36);
            var fmtdate9=new Array(7,37,3,37,11);
            var fmtdate10=new Array(38,25,2);

            function myIsNaN(x){
                return(isNaN(x)||(typeof x=='number'&&!isFinite(x)));
            }

            function round(n,nd){
                if(isFinite(n)&&isFinite(nd)){
                    var sign_n=(n<0)?-1:1;
                    var abs_n=Math.abs(n);
                    var factor=Math.pow(10,nd);
                    return sign_n*Math.round(abs_n*factor)/factor;
                }else{
                    return NaN;
                }
            }

            function b2s(b){
                return b?eetrue:eefalse;
            }

            function eeparseFloat(str){
                str=String(str).replace(eedecreg,".");
                var res=parseFloat(str);
                if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            function eeparsePercent(str){
                var parts=String(str).split('%');
                var tmp=String(parts[0]).replace(eedecreg,".");
                var res=parseFloat(tmp)/100;if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            var near0RegExp=new RegExp("[.](.*0000000|.*9999999)");
            function eedisplayFloat(x){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var str=String(x);
                    if(near0RegExp.test(str)){
                        x=round(x,8);
                        str=String(x);
                    }
                    return str.replace(/\./g,eedec);
                }
            }

            function eedisplayFloatV(x){
                if(x=="")return x;
                if(isFinite(x)){
                    return eedisplayFloat(x);
                }else{
                    return x;
                }
            }

            function eedisplayFloatND(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var res=round(x,nd);
                    if(nd>0){
                        var str=String(res);
                        if(str.indexOf('e')!=-1)
                            return str;
                        if(str.indexOf('E')!=-1)
                            return str;
                        var parts=str.split('.');
                        if(parts.length<2){
                            var decimals=('00000000000000').substring(0,nd);
                            return(parts[0]).toString()+eedec+decimals;
                        }else{
                            var decimals=((parts[1]).toString()+'00000000000000').substring(0,nd);
                            return(parts[0]).toString()+eedec+decimals;
                        }
                    }else{
                        return res;
                    }
                }
            }

            function eedisplayPercentND(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    return eedisplayFloatND(x*100,nd)+'%';
                }
            }

            function eeparseFloatTh(str){
                str=String(str).replace(eethreg,"");
                str=String(str).replace(eedecreg,".");
                var res=parseFloat(str);
                if(isNaN(res)){
                    return 0;
                }else{
                    return res;
                }
            }

            function eedisplayFloatNDTh(x,nd){
                if(myIsNaN(x)){
                    return Number.NaN;
                }else{
                    var res=round(x,nd);
                    if(nd>0){
                        var str=String(res);
                        if(str.indexOf('e')!=-1)
                            return str;
                        if(str.indexOf('E')!=-1)
                            return str;
                        var parts=str.split('.');
                        var res2=eeinsertThousand(parts[0].toString());
                        if(parts.length<2){
                            var decimals=('00000000000000').substring(0,nd);
                            return(res2+eedec+decimals);
                        }else{
                            var decimals=((parts[1]).toString()+'00000000000000').substring(0,nd);
                            return(res2+eedec+decimals);
                        }
                    }else{
                        return(eeinsertThousand(res.toString()));
                    }
                }
            }

            var eeparseFloatVreg=new RegExp("^ *-?[0-9.]+ *$");
            function eeparseFloatV(str){
                if(str=="")
                    return str;str=String(str).replace(eedecreg,".");
                if(!eeparseFloatVreg.test(str)){
                    return str;
                }
                var res=parseFloat(str);
                if(isNaN(res)){
                    return str;
                }else{
                    return res;
                }
            }

            function eeinsertThousand(whole){
                if(whole==""||whole.indexOf("e")>=0){
                    return whole;
                }else{
                    var minus_sign="";
                    if(whole.charAt(0)=="-"){
                        minus_sign="-";
                        whole=whole.substring(1);
                    }
                    var res="";
                    var str_length=whole.length-1;
                    for(var ii=0;ii<=str_length;ii++){
                        if(ii>0&&ii%3==0){
                            res=eeth+res;
                        }
                        res=whole.charAt(str_length-ii)+res;
                    }
                    return minus_sign+res;
                }
            }

            function validar(e){
                obj=e.srcElement || e.target;
                tecla_codigo = (document.all) ? e.keyCode : e.which;
                if(tecla_codigo==8)return true;
                patron =/[\d.]/;
                tecla_valor = String.fromCharCode(tecla_codigo);
                control=(tecla_codigo==46 && (/[.]/).test(obj.value))?false:true
                return patron.test(tecla_valor) && control;
            }
        </script>
        <script type="text/javascript" language="JavaScript">
            function currencyFormat(fld, milSep, decSep, e) {
                var key = '';
                var i =0, j = 0;
                var len =0, len2 = 0;
                var strCheck = '0123456789';
                var aux ='', aux2 = '';
                var whichCode = (window.Event) ? e.which : e.keyCode;
                if (whichCode == 13) return true; // Enter
                key = String.fromCharCode(whichCode); // Get key value from key code
                if (strCheck.indexOf(key) == -1) return false; // Not a valid key
                len = fld.value.length;
                for(i = 0; i < len; i++)
                    if ((fld.value.charAt(i) != '0') && (fld.value.charAt(i) != decSep)) break;
                aux = '';
                for(; i < len; i++)
                    if (strCheck.indexOf(fld.value.charAt(i))!=-1) aux += fld.value.charAt(i);
                aux += key;
                len = aux.length;
                if (len == 0) fld.value = '';
                if (len == 1) fld.value = '0'+ decSep + '0' + aux;
                if (len == 2) fld.value = '0'+ decSep + aux;
                if (len > 2) {
                    aux2 = '';
                    for (j = 0, i = len - 3; i >= 0; i--) {
                        if (j == 3) {
                            aux2 += milSep;
                            j = 0;
                        }
                        aux2 += aux.charAt(i);
                        j++;
                    }
                    fld.value = '';
                    len2 = aux2.length;
                    for (i = len2 - 1; i >= 0; i--)
                        fld.value += aux2.charAt(i);
                    fld.value += decSep + aux.substr(len - 2, len);
                }
                return false;
            }
        </script>
        <script type="text/javascript" language="JavaScript">
            var Aut = false;
            function ventanaNueva() {
                if(document.getElementById("chkKnegativo").checked==true){
                    document.getElementById("chkKnegativo").checked=false;
                    document.getElementById("lblinteres").style.display="none";
                    document.getElementById("txtinteress").style.display="none";
                    document.getElementById("lblCobroKnegativo").style.display="none";
                    document.getElementById("txtCobroKnegativo").style.display="none";
                    Dialog.confirm($('loginn').innerHTML,
                    { className:"alphacube",
                        width:400,
                        okLabel: "Confirmar",
                        title: "Autorizar Prestamo por falta de dinero en cuenta de Cliente",
                        cancelLabel: "Cancel",
                        onOk:function(){
                            var user =document.getElementById('user').value
                            var pass =document.getElementById('passwd').value
                            document.getElementById('res').innerHTML='';
                            Autorizar(user,pass);
                            window.alert('¡¡ DATOS ENVIADOS !!');
                            if(document.getElementById('res').innerHTML==1){
                                Aut = true;
                                document.getElementById("chkKnegativo").checked=true;
                                document.getElementById("lblinteres").style.display="";
                                document.getElementById("txtinteress").style.display="";
                                document.getElementById("lblCobroKnegativo").style.display="";
                                document.getElementById("txtCobroKnegativo").style.display="";
                                confirmarprestamo();
                                return true;
                            }else{
                                $('login_error_msg').innerHTML='Usuario o Contrase&ntilde;a incorrecto';
                                $('login_error_msg').show(); Windows.focusedWindow.updateHeight();
                                new Effect.Shake(Windows.focusedWindow.getId());
                                return false;
                            }
                        }
                    });
                }else{
                    document.getElementById("txtKnegativo").value="NO";
                    document.getElementById("lblinteres").style.display="none";
                    document.getElementById("txtinteress").style.display="none";
                    document.getElementById("lblCobroKnegativo").style.display="none";
                    document.getElementById("txtCobroKnegativo").style.display="none";
                }
            }

            var Aut = null;
            function ventanaNueva2() {
                if(document.getElementById("chkCobroPF").checked==true){
                    document.getElementById("chkCobroPF").checked=false;
                    Dialog.confirm($('loginn').innerHTML,
                    { className:"alphacube",
                        width:400,
                        okLabel: "Confirmar",
                        title: "Autorizar Usuario",
                        cancelLabel: "cancel",
                        onOk:function(){
                            var user =document.getElementById('user').value
                            var pass =document.getElementById('passwd').value
                            document.getElementById('res').innerHTML='';
                            Autorizar(user,pass);
                            window.alert('¡¡ DATOS ENVIADOS !!')
                            if(document.getElementById('res').innerHTML==1){
                                Aut = true;
                                document.getElementById("txtCobroPF").value="2649232134";
                                document.getElementById("chkCobroPF").checked=true;
                                return true;
                            }else{
                                $('login_error_msg').innerHTML='Usuario o Contrase&ntilde;a incorrecto';
                                $('login_error_msg').show(); Windows.focusedWindow.updateHeight();
                                new Effect.Shake(Windows.focusedWindow.getId());
                                return false;
                            }
                        }
                    });
                }else{
                    document.getElementById("txtCobroPF").value="x";
                }
            }

            function Autorizar(login,contrasenia) {
                req2 = null;
                if (window.XMLHttpRequest) {
                    req2 = new XMLHttpRequest();
                }else if (window.ActiveXObject) {
                    req2 = new ActiveXObject("Microsoft.XMLHTTP");
                }
                if(req2!=null){
                    req2.onreadystatechange = procesar1;
                    var PATH = "<%= request.getContextPath()%>";
                    var url = PATH + "/SAutorizarUsuario?login="+login+"&contrasenia="+contrasenia;
                    req2.open("GET",url,true);
                    req2.send(null);
                }
            }

            function procesar1(){
                contenido = document.getElementById('res');
                contenido.innerHTML="Cargando los datos...";
                contenido.innerHTML="";
                if (req2.readyState==4 && req2.status==200) {
                    contenido.innerHTML = req2.responseText;
                }
            }

            function confirmarprestamo(){
                document.getElementById("txtKnegativo").value="SI";
            }
        </script>
        <script type="text/javascript" language="JavaScript">
            function ImprimirTicket(){
                document.frmadmincuenta.action="reportecuenta.htm";
                document.frmadmincuenta.submit();
            }
        </script>
        <style type="text/css">
            .tableItems {
                border: 1px solid #008585;
                border-spacing: 0px;
                border-collapse: collapse;
            }

            .thItems {
                background: #008585;
                font-family: Arial;
                font-size: 12pt;
                color: #FFFFFF;
            }

            .tdItems {
                border: 1px solid #008585;
                font-family: Arial;
                font-size: 10pt;
            }

            .trItems {
                background: #FFFFFF;
            }

            .trItemspar {
                background: #9BCFCF;
            }
        </style>
    </head>
    <body>
        <%@include file="../common/header.jsp" %>
        <%
                    request.setAttribute("idmenu", "20110809142911505556");
        %>
        <div id="content">
            <div id="sidebar">
                <div id="menu">
                    <%@include file="../common/menu.jsp" %>
                </div>
                <div id="login" class="boxed">
                    <h2 class="title">Client Account</h2>
                    <div class="content">
                        <form id="form1" method="post" action="principal.htm">
                            <input id="inputsubmit1" type="submit" name="inputsubmit1" value="Salir" />
                        </form>
                    </div>
                </div>
            </div>
            <div id="main">
                <div id="welcome" class="post">
                    <img alt='Cargando ...' src='images/ajax/ajax-loader1.gif' style='display: none'/>
                    <h2 class="title">Administrar Intereses!</h2>
                    <h3 class="date"><span class="month"><script type="text/javascript">
                        var fecha=new Date();
                        var fmtmonthnamesshort=new Array("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre");
                        document.write(fmtmonthnamesshort[fecha.getMonth()]);
                            </script></span> <span class="day"><script type="text/javascript">
                                document.write(fecha.getDate());
                            </script></span><span class="year">, <script type="text/javascript">document.write(fecha.getFullYear());</script></span></h3>
                    <div id="loginn" style="display:none">
                        <p>
                            <span id='login_error_msg' class="login_error" style="display:none;font-size:15px;">&nbsp;</span>
                        </p>
                        <div style="clear:both;">
                        </div>
                        <p>
                            <span class="login_label">Usuario</span>
                            <span class="login_input">
                                <input type="text" id="user"/>
                            </span>
                        </p>
                        <div style="clear:both;"></div>
                        <p>
                            <span class="login_label">Contrase&ntilde;a</span>
                            <span class="login_input">
                                <input type="password" id="passwd"/>
                            </span>
                        </p>
                        <div style="clear:both;">
                        </div>
                        <div id="res" style="display:none;">
                        </div>
                    </div>
                    <div class="story">
                        <form id="frmadmincuenta" name="frmadmincuenta" action="<%= request.getContextPath()%>/NuevaCuentaController.java" method="post">
                            <table>
                                <tr>
                                    <td colspan="2"><div id="divTipoTrans">
                                            <table>
                                                <tr><td>
                                                        <div id="divBotonCrear">
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">
                                                        <fieldset style="border-width:3px">
                                                            <legend><b>BUSCAR POR:</b></legend>
                                                            <table>
                                                                <tr>
                                                                    <td><input type="text" id="txtTempSelTipB" name="txtTempSelTipB" value="" style="display:none">
                                                                        <input type="text" id="txtTempdataB" name="txtTempdataB" value="" style="display:none">
                                                                        <input type="text" id="txtbanz" name="txtbanz" value="" style="display:none">
                                                                        <input type="text" id="txtestados" name="txtestados" value="0" style="display:none">
                                                                        <select id="selTipoBus" name="selTipoBus" onchange="validartxtBusqueda();" >
                                                                            <option value="0">(Seleccione Tipo Busqueda)</option>
                                                                            <option>NUMERO DE CUENTA</option>
                                                                            <option>DNI</option>
                                                                            <option>RUC</option>
                                                                            <option>NOMBRE</option>
                                                                            <option>APELLIDO</option>
                                                                        </select>
                                                                    </td>
                                                                    <td><div id="divtxtBuscar"><input id="txtBuscar" type="text" disabled name="txtBuscar" value="" onkeypress='return soloNumeroTelefonico(event);' /></div></td>
                                                                    <td colspan="4"><input id="btnBuscarCtas" type="button" value="BuscarCuenta"onclick="vercuenta()" /></td>
                                                                </tr>
                                                            </table>
                                                        </fieldset>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="6"><div id="divlistPerCuentas"></div></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="6"><div id="tableMiscuentas"></div></td>
                                                </tr>
                                                <tr style="display: none;">
                                                    <td colspan="6">
                                                        <input type="hidden" id="txtfilial" name="txtfilial" value="<%= session.getAttribute("USER_FILIAL")%>">
                                                        <input type="hidden" id="txtcodCaja" name="txtcodCaja" value="<%= session.getAttribute("USER_CODCAJA")%>">
                                                        <input type="hidden" id="txtFecha" name="txtFecha" value="<%= DateUtil.getNOW_S()%>">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="6"><div id="tableReports"></div><div id="tableReportx" style="display: none"></div></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><div id="divesperarCap" style="display: none;"></div><div id="divesperarservlet"></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div id="divcuenta"></div>
                                        <script type="text/javascript">document.getElementById('selTipoBus').focus();</script>
                                    </td>
                                </tr>
                                <tr>
                                    <td><div id="ver"></div>
                                    </td>
                                </tr>
                            </table>
                        </form>
                        <form id="frmiraticket" name="frmiraticket" method="post" action="ticket.htm">
                        </form>
                        <input type="hidden" id="txtind" name="txtind" value="">
                        <form id="frmIrEstadoCuenta" name="frmIrEstadoCuenta" method="post" action="estadodecuenta.htm">
                        </form>
                        <form id="frmActualizar" name="frmActualizar" method="post" action="managerint.htm">
                        </form>
                    </div>
                </div>
            </div><img alt="Cargando ..." src="images/ajax/ajax-loader1.gif" style="display: none;"/>
        </div>
        <%@include file="../common/footer.jsp" %>
    </body>
</html>
